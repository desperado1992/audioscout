#
# $Id: Makefile.all,v 1.4 1998/03/26 05:30:21 gray Exp $
#

HFLS	= table.h
OBJS	= table.o

CC	= gcc

# If your system supports mmap, comment this out.


#CFLAGS =  -Dwin32
CFLAGS = -Dunix -fPIC

CFLAGS +=  -g -O3
CPPFLAGS = -I.

LDFLAGS	= -L.
RANLIB	= ranlib

DESTDIR	= /usr/local
TEST	= table_t
UTIL	= table_util
LIBRARY	= libtable.a

all : $(LIBRARY) $(UTIL)

clean :
	rm -f a.exe core *.o *.t
	rm -f $(LIBRARY) $(UTIL) $(TEST)

install : $(HFLS) $(LIBRARY) $(UTIL)
	$(RANLIB) $(LIBRARY)
	install -c -m 444 $(HFLS) $(DESTDIR)/include
	install -c -m 444 $(LIBRARY) $(DESTDIR)/lib
	install -c $(UTIL) $(DESTDIR)/bin

$(LIBRARY) : $(OBJS)
	cp table.o ..
	ar cr $(LIBRARY) $?
	$(RANLIB) $@

tests : $(TEST)

$(TEST) : $(TEST).o $(LIBRARY)
	rm -f $@
	$(CC) $(LDFLAGS) $(TEST).o $(LIBRARY)
	mv a.out $@

utils : $(UTIL)

$(UTIL) : $(UTIL).o $(LIBRARY)
	rm -f $@
	$(CC) $(LDFLAGS) $(UTIL).o $(LIBRARY)
	mv a.out $@

.c.o :
	rm -f $@
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $< -o $@

#
# Below are dependencies that are automatically generated by make
# depend.  Please do not edit by hand.
#

table.o: table.c table.h table_loc.h
table_t.o: table_t.c table.h
table_util.o: table_util.c table.h
